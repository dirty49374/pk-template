#!/usr/bin/env pkt

input:
  kind: Deployment
  name: null
  image: alpine:latest
  label: app
  port: 0
  service: ClusterIP
  host: null
  path: /

assign:
  name$: |
    name if name
    path = image.split(':')[0].split('/')
    path[path.length - 1]

routine:
- include: deployment.pkt
- if: port
  include: service.pkt
- if: port && host
  include: ingress.pkt